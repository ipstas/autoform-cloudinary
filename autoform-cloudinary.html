<template name="afCloudinary">
  <div class="afCloudinary">
    {{#if url}}
      <div class="afCloudinary-thumbnail">
          <a href="{{url}}" target="_blank">
              {{#unless file}}
                  <img class="img-responsive" alt="{{filename}}" src="{{url}}">
              {{else}}
                  <p>{{filename}}</p>
              {{/unless}}
          </a>
      </div>
      <a href="#" class="js-remove">Remove</a>
    {{else}}
      <button
        type="button">
        Browse
      </button>
    {{/if}}
		{{errorState}}
    <input
      name="file"
      type="file"
      class="cloudinary-fileupload"
      data-cloudinary-field="image_id"
      style="display: none"
      accept="{{accept}}"/>
    <input {{atts}}
      type="hidden"
      name="url"
      value="{{url}}"/>
  </div>
</template>

<template name="afCloudinary_bootstrap3">
  <div class="afCloudinary afCloudinary_bootstrap3 animated fadeIn ">
		{{#if iffiles}}
			{{#each files}}				
				<div class="afCloudinary-multi">
				{{#if url}}
					<div id="imgurl" class="afCloudinary-thumbnail form-group animated fadeIn text-center">
						<img class="animated fadeIn" alt="{{filename}}" onLoad="this.src='{{thumbnail}}'" src="/packages/ipstas_autoform-cloudinary/loading.gif" >
					</div>
					<div>{{filename}}</div>
					<input {{addatts}} {{atts}}
						style="display: none"
						id="{{filename}}"	
						type="hidden"
						name="url"
						value="{{url}}"/>
					<input 
						style="display: none"
						type="hidden"
						name="file"
						data-schema-key="file"
						value="{{filename}}"/>
					<a href="#" class="js-remove" id="{{cloudId}}"><span class="glyphicon glyphicon-remove animated fadeIn "></span> Remove</a>
					{{#unless submitted}}
						{{#unless dimensions}}
						<span type="submit" class="pointer submit"><span class="glyphicon glyphicon-ok animated fadeIn ">OK</span></span>
						{{/unless}}
					{{/unless}}
					<button type="submit" id="{{cloud}}" class="btnsub btn btn-block btn-default hidden">OK</button>
					{{#with dimensions}}
						<div class="red">
							Wrong size {{width}}:{{height}}. Should be 2:1
						</div>
					{{/with}}
				{{else}}
					<!-- use advanced=true in the form to show it -->
					{{#if atts.advanced}}
						<div class="row animated fadeIn ">
							<div class="col-xs-6 col-sm-2">
								<input type="text" id="resource_type" name="type" placeholder="input" class="cloudinary-atts form-control" value="{{addatts.accept}}" disabled>
							</div>
							<div class="col-xs-6 col-sm-2">
								<input type="text" id="folder" name="folder" placeholder="subfolder" class="cloudinary-atts form-control" value="{{addatts.folder}}">
							</div>
							<div class="col-xs-7 col-sm-5">
								<input type="text" id="tags" name="tags" placeholder="tags" class="cloudinary-atts form-control" value="{{addatts.tags}}">
							</div>
							<div class="col-xs-5 col-sm-3">
								<div role="button" class="drophere jumbotron jumbotron-fluid browse btn-default text-center animated fadeIn ">
									<i class="fa fa-cloud-upload linkblue pointer animated fadeIn " aria-hidden="true"></i>
								</div>						
							</div>
						</div>
					{{else}}
						<div role="button" class="drophere jumbotron jumbotron-fluid btn-default animated fadeIn ">
							{{#if progress}}
								{{progress}}%
							{{else}}
								0%
							{{/if}}
						</div>		
					{{/if}}
				{{/if}}
				</div>
			{{/each}}
		{{else}}
			{{#if url}}
				<div id="imgurl" class="afCloudinary-thumbnail form-group animated fadeIn text-center">
					<img class="animated fadeIn" alt="{{filename}}" onLoad="this.src='{{thumbnail}}'" src="/packages/ipstas_autoform-cloudinary/loading.gif" >
				</div>
<!-- 				<a href="#" class="js-remove" id="{{cloudId}}"><span class="glyphicon glyphicon-remove animated fadeIn "></span> Remove</a> -->
				<a href="#" class="replace uploader browse" id="{{cloudId}}"><span class="glyphicon glyphicon-remove animated fadeIn "></span> Replace</a>
			{{else}}
				<div role="button" class="uploader drophere jumbotron jumbotron-fluid browse btn-default animated fadeIn ">
					<i class="fa fa-cloud-upload linkblue pointer animated fadeIn " aria-hidden="true"></i>
				</div>	
			{{/if}}
		{{/if}}
		{{errorState}}
    <input
			tags="cloudinary-fileupload"
			multiple
			id="cloudinary-filename"
      name="file"
      type="file"
      class="cloudinary-fileupload form-control"
      data-cloudinary-field="image_id"
      style="display: none"
      accept="{{accept}}"/>
  </div>
</template>

<template name="afCloudinary_file">
  <div class="afCloudinary afCloudinary_file">
		
    {{#if url}}
			
				<div class="afCloudinary-thumbnail  form-group">
					<p><i class="fa fa-file" aria-hidden="true"></i> {{filename}}</p>
				</div>
				<a href="#" id="{{cloudId}}" class="js-remove"><span class="glyphicon glyphicon-remove"></span> Remove</a>

    {{else}}
			{{#if atts.advanced}}
				<div class="row">
					<div class="col-xs-2 col-sm-2">
						<input type="text" id="resource_type" name="type" placeholder="input" class="cloudinary-atts form-control" value="{{addatts.accept}}" disabled>
					</div>
					<div class="col-xs-2 col-sm-2">
						<input type="text" id="folder" name="folder" placeholder="subfolder" class="cloudinary-atts form-control" value="{{addatts.folder}}">
					</div>
					<div class="col-xs-5 col-sm-5">
						<input type="text" id="tags" name="tags" placeholder="tags" class="cloudinary-atts form-control" value="{{addatts.tags}}">
					</div>
					<div class="col-xs-3 col-sm-3">
						<button
							type="button"
							class="btn btn-default wd100">
							Browse
						</button>
					</div>
				</div>
			{{else}}
				<button
					type="button"
					class="btn btn-default">
					Browse
				</button>			
			{{/if}}

    {{/if}}
		{{errorState}}
    <input
			id="afCloudinary_file"
			tags="cloudinary-fileupload"
      name="file"
      type="file"
      class="cloudinary-fileupload form-control"
      data-cloudinary-field="image_id"
      style="display: none"
      accept="{{accept}}"/>
    <input {{addatts}} {{atts}}
			style="display: none"
      type="hidden"
      name="url"
      value="{{url}}"/>
  </div>
</template>

<template name="afArrayField_cloudinary">
    <div class="panel panel-default">
        <div class="panel-heading">{{afFieldLabelText name=this.atts.name}}</div>
      {{#if afFieldIsInvalid name=this.atts.name}}
          <div class="panel-body has-error">
              <span class="help-block">{{{afFieldMessage name=this.atts.name}}}</span>
          </div>
      {{/if}}
        <ul class="list-group">
          {{#afEachArrayItem name=this.atts.name minCount=this.atts.minCount maxCount=this.atts.maxCount}}
              <li class="list-group-item autoform-array-item">
                  <div>
                      <div class="autoform-remove-item-wrap">
                        {{#if afArrayFieldHasMoreThanMinimum name=../atts.name minCount=../atts.minCount maxCount=../atts.maxCount}}
                            <button type="button" class="btn btn-primary autoform-remove-item"><span class="glyphicon glyphicon-minus"></span></button>
                        {{/if}}
                      </div>
                      <div class="autoform-array-item-body xx">
                        {{> afQuickField template="bootstrap3" name=this.name label=false folder=../atts.folder tags=../atts.tags accept=../atts.accept resourceType=../atts.resourceType}}
												{{debug}}
                      </div>
                  </div>
              </li>
          {{/afEachArrayItem}}
          {{#if afArrayFieldHasLessThanMaximum name=this.atts.name minCount=this.atts.minCount maxCount=this.atts.maxCount}}
              <li class="list-group-item">
                  <button type="button" class="btn btn-primary autoform-add-item" data-autoform-field="{{this.atts.name}}" data-autoform-minCount="{{this.atts.minCount}}" data-autoform-maxCount="{{this.atts.maxCount}}"><span class="glyphicon glyphicon-plus"></span></button>
              </li>
							{{debug}}
          {{/if}}
        </ul>
    </div>
</template>
